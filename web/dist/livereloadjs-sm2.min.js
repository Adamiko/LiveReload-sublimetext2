/*! livereloadjs-sm2 - v2.0.9 - 2013-02-17
* Copyright (c) 2013 dz0ny; Licensed MIT */
(function(){var e;e=function(){function e(){}return e.bind=function(e,t,o){if(e.addEventListener)return e.addEventListener(t,o,!1);if(e.attachEvent)return e[t]=1,e.attachEvent("onpropertychange",function(e){return e.propertyName===t?o():void 0});throw Error("Attempt to attach custom event "+t+" to something which isn't a DOMElement")},e.fire=function(e,t){var o;if(e.addEventListener)return o=document.createEvent("HTMLEvents"),o.initEvent(t,!0,!0),document.dispatchEvent(o);if(!e.attachEvent)throw Error("Attempt to fire custom event "+t+" on something which isn't a DOMElement");return e[t]?e[t]++:void 0},e}();var t,o,n,i,r=[].indexOf||function(e){for(var t=0,o=this.length;o>t;t++)if(t in this&&this[t]===e)return t;return-1};t="http://livereload.com/protocols/official-6",o="http://livereload.com/protocols/official-7",i=i=function(){function e(e,t){this.message="LiveReload protocol error ("+e+') after receiving data: "'+t+'".'}return e}(),n=n=function(){function e(e){this.handlers=e,this.reset()}return e.prototype.reset=function(){return this.protocol=null},e.prototype.process=function(e){var n,s,l,c;try{if(null==this.protocol){if(e.match(/^!!ver:([\d.]+)$/))this.protocol=6;else if(s=this._parseMessage(e,["hello"])){if(!s.protocols.length)throw new i("no protocols specified in handshake message");if(r.call(s.protocols,o)>=0)this.protocol=7;else{if(!(r.call(s.protocols,t)>=0))throw new i("no supported protocols found");this.protocol=6}}return this.handlers.connected(this.protocol)}if(6===this.protocol){if(s=JSON.parse(e),!s.length)throw new i("protocol 6 messages must be arrays");if(n=s[0],l=s[1],"refresh"!==n)throw new i("unknown protocol 6 command");return this.handlers.message({command:"reload",path:l.path,liveCSS:null!=(c=l.apply_css_live)?c:!0})}return s=this._parseMessage(e,["reload","alert","url","plugin"]),this.handlers.message(s)}catch(a){if(a instanceof i)return this.handlers.error(a);throw a}},e.prototype._parseMessage=function(e,t){var o,n;try{o=JSON.parse(e)}catch(s){throw new i("unparsable JSON",e)}if(!o.command)throw new i('missing "command" key',e);if(n=o.command,0>r.call(t,n))throw new i("invalid command '"+o.command+"', only valid commands are: "+t.join(", ")+")",e);return o},e}();var s,l;l="2.0.8",s=function(){function e(e,t,o,i){var r=this;this.options=e,this.WebSocket=t,this.Timer=o,this.handlers=i,this._uri="ws://"+this.options.host+":"+this.options.port+"/livereload",this._nextDelay=this.options.mindelay,this._connectionDesired=!1,this.protocol=0,this.protocolParser=new n({connected:function(e){return r.protocol=e,r._handshakeTimeout.stop(),r._nextDelay=r.options.mindelay,r._disconnectionReason="broken",r.handlers.connected(e)},error:function(e){return r.handlers.error(e),r._closeOnError()},message:function(e){return r.handlers.message(e)}}),this._handshakeTimeout=new o(function(){return r._isSocketConnected()?(r._disconnectionReason="handshake-timeout",r.socket.close()):void 0}),this._reconnectTimer=new o(function(){return r._connectionDesired?r.connect():void 0}),this.connect()}return e.prototype._isSocketConnected=function(){return this.socket&&this.socket.readyState===this.WebSocket.OPEN},e.prototype.connect=function(){var e=this;return this._connectionDesired=!0,this._isSocketConnected()?void 0:(this._reconnectTimer.stop(),this._disconnectionReason="cannot-connect",this.protocolParser.reset(),this.handlers.connecting(),this.socket=new this.WebSocket(this._uri),this.socket.onopen=function(t){return e._onopen(t)},this.socket.onclose=function(t){return e._onclose(t)},this.socket.onmessage=function(t){return e._onmessage(t)},this.socket.onerror=function(t){return e._onerror(t)})},e.prototype.disconnect=function(){return this._connectionDesired=!1,this._reconnectTimer.stop(),this._isSocketConnected()?(this._disconnectionReason="manual",this.socket.close()):void 0},e.prototype._scheduleReconnection=function(){return this._connectionDesired?this._reconnectTimer.running?void 0:(this._reconnectTimer.start(this._nextDelay),this._nextDelay=Math.min(this.options.maxdelay,2*this._nextDelay)):void 0},e.prototype.sendCommand=function(e){return null!=this.protocol?this._sendCommand(e):void 0},e.prototype._sendCommand=function(e){return this.socket.send(JSON.stringify(e))},e.prototype._closeOnError=function(){return this._handshakeTimeout.stop(),this._disconnectionReason="error",this.socket.close()},e.prototype._onopen=function(){var e;return this.handlers.socketConnected(),this._disconnectionReason="handshake-failed",e={command:"hello",protocols:[t,o]},e.ver=l,this.options.ext&&(e.ext=this.options.ext),this.options.extver&&(e.extver=this.options.extver),this.options.snipver&&(e.snipver=this.options.snipver),this._sendCommand(e),this._handshakeTimeout.start(this.options.handshake_timeout)},e.prototype._onclose=function(){return this.protocol=0,this.handlers.disconnected(this._disconnectionReason,this._nextDelay),this._scheduleReconnection()},e.prototype._onerror=function(){},e.prototype._onmessage=function(e){return this.protocolParser.process(e.data)},e}();var c;c=function(){function e(e){var t=this;this.func=e,this.running=!1,this.id=null,this._handler=function(){return t.running=!1,t.id=null,t.func()}}return e.prototype.start=function(e){return this.running&&clearTimeout(this.id),this.id=setTimeout(this._handler,e),this.running=!0},e.prototype.stop=function(){return this.running?(clearTimeout(this.id),this.running=!1,this.id=null):void 0},e}();var a;a=function(){function e(){this.host=null,this.port=35729,this.snipver=null,this.ext=null,this.extver=null,this.mindelay=1e3,this.maxdelay=6e4,this.handshake_timeout=5e3}return e.prototype.set=function(e,t){switch(typeof this[e]){case"undefined":break;case"number":return this[e]=+t;default:return this[e]=t}},e.extract=function(t){var o,n,i,r,s,l,c,a,h,u,d,p,f;for(p=t.getElementsByTagName("script"),a=0,u=p.length;u>a;a++)if(o=p[a],(c=o.src)&&(i=c.match(/^[^:]+:\/\/(.*)\/z?livereload\.js(?:\?(.*))?$/))){if(s=new e,(r=i[1].match(/^([^\/:]+)(?::(\d+))?$/))&&(s.host=r[1],r[2]&&(s.port=parseInt(r[2],10))),i[2])for(f=i[2].split("&"),h=0,d=f.length;d>h;h++)l=f[h],(n=l.split("=")).length>1&&s.set(n[0].replace(/-/g,"_"),n.slice(1).join("="));return s}return null},e}();var h,u,d,p,f,m,g;g=function(e){var t,o,n;return(o=e.indexOf("#"))>=0?(t=e.slice(o),e=e.slice(0,o)):t="",(o=e.indexOf("?"))>=0?(n=e.slice(o),e=e.slice(0,o)):n="",{url:e,params:n,hash:t}},p=function(e){var t;return e=g(e).url,t=0===e.indexOf("file://")?e.replace(/^file:\/\/(localhost)?/,""):e.replace(/^([^:]+:)?\/\/([^:\/]+)(:\d*)?\//,"/"),decodeURIComponent(t)},m=function(e,t,o){var n,i,r,s,l;for(n={score:0},s=0,l=t.length;l>s;s++)i=t[s],r=d(e,o(i)),r>n.score&&(n={object:i,score:r});return n.score>0?n:null},d=function(e,t){var o,n,i,r;if(e=e.replace(/^\/+/,"").toLowerCase(),t=t.replace(/^\/+/,"").toLowerCase(),e===t)return 1e4;for(o=e.split("/").reverse(),n=t.split("/").reverse(),r=Math.min(o.length,n.length),i=0;r>i&&o[i]===n[i];)++i;return i},f=function(e,t){return d(e,t)>0},h=[{selector:"background",styleNames:["backgroundImage"]},{selector:"border",styleNames:["borderImage","webkitBorderImage","MozBorderImage"]}],u=u=function(){function e(e,t,o){this.window=e,this.console=t,this.Timer=o,this.document=this.window.document,this.importCacheWaitPeriod=200,this.plugins=[]}return e.prototype.addPlugin=function(e){return this.plugins.push(e)},e.prototype.analyze=function(){return results},e.prototype.reload=function(e,t){var o,n,i,r,s,l;for(this.options=t,null==(s=(n=this.options).stylesheetReloadTimeout)&&(n.stylesheetReloadTimeout=15e3),l=this.plugins,i=0,r=l.length;r>i;i++)if(o=l[i],o.reload&&o.reload(e,t))return;return t.liveCSS&&e.match(/\.css$/i)&&this.reloadStylesheet(e)?void 0:t.liveImg&&e.match(/\.(jpe?g|png|gif)$/i)?(this.reloadImages(e),void 0):this.reloadPage()},e.prototype.reloadPage=function(){return this.window.document.location.reload()},e.prototype.reloadImages=function(e){var t,o,n,i,r,s,l,c,a,u,d,m,g,v,y,w,_,R;for(t=this.generateUniqueString(),v=this.document.images,s=0,u=v.length;u>s;s++)o=v[s],f(e,p(o.src))&&(o.src=this.generateCacheBustUrl(o.src,t));if(this.document.querySelectorAll)for(l=0,d=h.length;d>l;l++)for(y=h[l],n=y.selector,i=y.styleNames,w=this.document.querySelectorAll("[style*="+n+"]"),c=0,m=w.length;m>c;c++)o=w[c],this.reloadStyleImages(o.style,i,e,t);if(this.document.styleSheets){for(_=this.document.styleSheets,R=[],a=0,g=_.length;g>a;a++)r=_[a],R.push(this.reloadStylesheetImages(r,e,t));return R}},e.prototype.reloadStylesheetImages=function(e,t,o){var n,i,r,s,l,c,a;try{i=null!=e?e.cssRules:void 0}catch(u){}if(i)for(s=0,c=i.length;c>s;s++)switch(n=i[s],n.type){case CSSRule.IMPORT_RULE:this.reloadStylesheetImages(n.styleSheet,t,o);break;case CSSRule.STYLE_RULE:for(l=0,a=h.length;a>l;l++)r=h[l].styleNames,this.reloadStyleImages(n.style,r,t,o);break;case CSSRule.MEDIA_RULE:this.reloadStylesheetImages(n,t,o)}},e.prototype.reloadStyleImages=function(e,t,o,n){var i,r,s,l,c,a=this;for(l=0,c=t.length;c>l;l++)r=t[l],s=e[r],"string"==typeof s&&(i=s.replace(/\burl\s*\(([^)]*)\)/,function(e,t){return f(o,p(t))?"url("+a.generateCacheBustUrl(t,n)+")":e}),i!==s&&(e[r]=i))},e.prototype.reloadStylesheet=function(e){var t,o,n,i,r,s,l,c,a,h,u,d,f,g,v,y=this;for(n=function(){var e,t,n,i;for(n=this.document.getElementsByTagName("link"),i=[],e=0,t=n.length;t>e;e++)o=n[e],"stylesheet"!==o.rel||o.__LiveReload_pendingRemoval||i.push(o);return i}.call(this),t=[],g=this.document.getElementsByTagName("style"),s=0,h=g.length;h>s;s++)r=g[s],r.sheet&&this.collectImportedStylesheets(r,r.sheet,t);for(l=0,u=n.length;u>l;l++)o=n[l],this.collectImportedStylesheets(o,o.sheet,t);if(this.window.StyleFix&&this.document.querySelectorAll)for(v=this.document.querySelectorAll("style[data-href]"),c=0,d=v.length;d>c;c++)r=v[c],n.push(r);if(this.console.log("LiveReload found "+n.length+" LINKed stylesheets, "+t.length+" @imported stylesheets"),i=m(e,n.concat(t),function(e){return p(y.linkHref(e))}))i.object.rule?(this.console.log("LiveReload is reloading imported stylesheet: "+i.object.href),this.reattachImportedRule(i.object)):(this.console.log("LiveReload is reloading stylesheet: "+this.linkHref(i.object)),this.reattachStylesheetLink(i.object));else for(this.console.log("LiveReload will reload all stylesheets because path '"+e+"' did not match any specific one"),a=0,f=n.length;f>a;a++)o=n[a],this.reattachStylesheetLink(o);return!0},e.prototype.collectImportedStylesheets=function(e,t,o){var n,i,r,s,l;try{r=null!=t?t.cssRules:void 0}catch(c){}if(r&&r.length)for(n=s=0,l=r.length;l>s;n=++s)switch(i=r[n],i.type){case CSSRule.CHARSET_RULE:continue;case CSSRule.IMPORT_RULE:o.push({link:e,rule:i,index:n,href:i.href}),this.collectImportedStylesheets(e,i.styleSheet,o);break;default:}},e.prototype.waitUntilCssLoads=function(e,t){var o,n,i,r=this;return o=!1,n=function(){return o?void 0:(o=!0,t())},e.onload=function(){return console.log("onload!"),r.knownToSupportCssOnLoad=!0,n()},this.knownToSupportCssOnLoad||(i=function(){return e.sheet?(console.log("polling!"),n()):r.Timer.start(50,i)})(),this.Timer.start(this.options.stylesheetReloadTimeout,n)},e.prototype.linkHref=function(e){return e.href||e.getAttribute("data-href")},e.prototype.reattachStylesheetLink=function(e){var t,o,n=this;if(!e.__LiveReload_pendingRemoval)return e.__LiveReload_pendingRemoval=!0,"STYLE"===e.tagName?(t=this.document.createElement("link"),t.rel="stylesheet",t.media=e.media,t.disabled=e.disabled):t=e.cloneNode(!1),t.href=this.generateCacheBustUrl(this.linkHref(e)),o=e.parentNode,o.lastChild===e?o.appendChild(t):o.insertBefore(t,e.nextSibling),this.waitUntilCssLoads(t,function(){var o;return o=/AppleWebKit/.test(navigator.userAgent)?5:200,n.Timer.start(o,function(){var o;if(e.parentNode)return e.parentNode.removeChild(e),t.onreadystatechange=null,null!=(o=n.window.StyleFix)?o.link(t):void 0})})},e.prototype.reattachImportedRule=function(e){var t,o,n,i,r,s,l,c,a=this;return l=e.rule,o=e.index,n=e.link,s=l.parentStyleSheet,t=this.generateCacheBustUrl(l.href),i=l.media.length?[].join.call(l.media,", "):"",r='@import url("'+t+'") '+i+";",l.__LiveReload_newHref=t,c=this.document.createElement("link"),c.rel="stylesheet",c.href=t,c.__LiveReload_pendingRemoval=!0,n.parentNode&&n.parentNode.insertBefore(c,n),this.Timer.start(this.importCacheWaitPeriod,function(){return c.parentNode&&c.parentNode.removeChild(c),l.__LiveReload_newHref===t?(s.insertRule(r,o),s.deleteRule(o+1),l=s.cssRules[o],l.__LiveReload_newHref=t,a.Timer.start(a.importCacheWaitPeriod,function(){return l.__LiveReload_newHref===t?(s.insertRule(r,o),s.deleteRule(o+1)):void 0})):void 0})},e.prototype.generateUniqueString=function(){return"livereload="+Date.now()},e.prototype.generateCacheBustUrl=function(e,t){var o,n,i,r;return null==t&&(t=this.generateUniqueString()),r=g(e),e=r.url,o=r.hash,n=r.params,this.options.overrideURL&&0>e.indexOf(this.options.serverURL)&&(e=this.options.serverURL+this.options.overrideURL+"?url="+encodeURIComponent(e)),i=n.replace(/(\?|&)livereload=(\d+)/,function(e,o){return""+o+t}),i===n&&(i=0===n.length?"?"+t:""+n+"&"+t),e+i+o},e}();var v;v=function(){function e(e){var t=this;return this.window=e,this.listeners={},this.plugins=[],this.pluginIdentifiers={},this.console=this.window.location.href.match(/LR-verbose/)&&this.window.console&&this.window.console.log&&this.window.console.error?this.window.console:{log:function(){},error:function(){}},(this.WebSocket=this.window.WebSocket||this.window.MozWebSocket)?(this.options=a.extract(this.window.document))?(this.reloader=new u(this.window,this.console,c),this.connector=new s(this.options,this.WebSocket,c,{connecting:function(){},socketConnected:function(){},connected:function(e){var o;return"function"==typeof(o=t.listeners).connect&&o.connect(),t.log("LiveReload is connected to "+t.options.host+":"+t.options.port+" (protocol v"+e+")."),t.analyze()},error:function(e){return e instanceof i?console.log(""+e.message+"."):console.log("LiveReload internal error: "+e.message)},disconnected:function(e,o){var n;switch("function"==typeof(n=t.listeners).disconnect&&n.disconnect(),e){case"cannot-connect":return t.log("LiveReload cannot connect to "+t.options.host+":"+t.options.port+", will retry in "+o+" sec.");case"broken":return t.log("LiveReload disconnected from "+t.options.host+":"+t.options.port+", reconnecting in "+o+" sec.");case"handshake-timeout":return t.log("LiveReload cannot connect to "+t.options.host+":"+t.options.port+" (handshake timeout), will retry in "+o+" sec.");case"handshake-failed":return t.log("LiveReload cannot connect to "+t.options.host+":"+t.options.port+" (handshake failed), will retry in "+o+" sec.");case"manual":break;case"error":break;default:return t.log("LiveReload disconnected from "+t.options.host+":"+t.options.port+" ("+e+"), reconnecting in "+o+" sec.")}},message:function(e){switch(e.command){case"reload":return t.performReload(e);case"alert":return t.performAlert(e);case"url":return t.performURL(e);case"plugin":return t.performPlugin(e)}}}),void 0):(console.error("LiveReload disabled because it could not find its own <SCRIPT> tag"),void 0):(console.error("LiveReload disabled because the browser does not seem to support web sockets"),void 0)}return e.prototype.on=function(e,t){return this.listeners[e]=t},e.prototype.log=function(e){return this.console.log(""+e)},e.prototype.performReload=function(e){var t,o;return this.log("LiveReload received reload request for "+e.path+"."),this.reloader.reload(e.path,{liveCSS:null!=(t=e.liveCSS)?t:!0,liveImg:null!=(o=e.liveImg)?o:!0,originalPath:e.originalPath||"",overrideURL:e.overrideURL||"",serverURL:"http://"+this.options.host+":"+this.options.port})},e.prototype.performAlert=function(e){return alert(e.message)},e.prototype.performURL=function(e){return document.location=e.url},e.prototype.performPlugin=function(e){return this.processPluginCommand(e)},e.prototype.shutDown=function(){var e;return this.connector.disconnect(),this.log("LiveReload disconnected."),"function"==typeof(e=this.listeners).shutdown?e.shutdown():void 0},e.prototype.hasPlugin=function(e){return!!this.pluginIdentifiers[e]},e.prototype.addPlugin=function(e){var t,o=this;this.hasPlugin(e.identifier)||(this.pluginIdentifiers[e.identifier]=!0,t=new e(this.window,{_livereload:this,_reloader:this.reloader,_connector:this.connector,console:this.console,Timer:c,generateCacheBustUrl:function(e){return o.reloader.generateCacheBustUrl(e)}}),this.plugins.push(t),this.reloader.addPlugin(t))},e.prototype.analyze=function(){var e,t,o,n,i,r;if(this.connector.protocol>=7){for(o={},r=this.plugins,n=0,i=r.length;i>n;n++)e=r[n],o[e.constructor.identifier]=t=("function"==typeof e.analyze?e.analyze():void 0)||{},t.version=e.constructor.version;this.connector.sendCommand({command:"info",plugins:o,url:this.window.location.href})}},e.prototype.processPluginCommand=function(e){var t,o,n,i,r;if(this.connector.protocol>=7){for(i=this.plugins,r=[],o=0,n=i.length;n>o;o++)t=i[o],t.constructor.identifier===e.identifier?r.push(null!=t?"function"==typeof t.processCommand?t.processCommand(e):void 0:void 0):r.push(void 0);return r}},e}();var y,w,_=function(e,t){return function(){return e.apply(t,arguments)}};w=function(){function e(e,t){this.window=e,this.host=t,this.sendCommand=_(this.sendCommand,this),this.processCommand=_(this.processCommand,this)}return e.identifier="socket",e.version="1.0",e.prototype.processCommand=function(e){return console.log(e)},e.prototype.sendCommand=function(e){return this.host._connector.sendCommand(e)},e.prototype.analyze=function(){return{disable:!1}},e}(),y=window.LiveReloadPluginSocket=w;var R,S;R=function(){function e(e,t){this.window=e,this.host=t}return e.identifier="less",e.version="1.0",e.prototype.reload=function(e,t){if(this.window.less&&this.window.less.refresh){if(e.match(/\.less$/i))return this.reloadLess(e);if(t.originalPath.match(/\.less$/i))return this.reloadLess(t.originalPath)}return!1},e.prototype.reloadLess=function(){var e,t,o,n;if(t=function(){var t,o,n,i;for(n=document.getElementsByTagName("link"),i=[],t=0,o=n.length;o>t;t++)e=n[t],(e.href&&"stylesheet/less"===e.rel||e.rel.match(/stylesheet/)&&e.type.match(/^text\/(x-)?less$/))&&i.push(e);return i}(),0===t.length)return!1;for(o=0,n=t.length;n>o;o++)e=t[o],e.href=this.host.generateCacheBustUrl(e.href);return this.host.console.log("LiveReload is asking LESS to recompile all stylesheets"),this.window.less.refresh(!0),!0},e.prototype.analyze=function(){return{disable:!(!this.window.less||!this.window.less.refresh)}},e}(),S=window.LiveReloadPluginLess=R;var v,k;v=window.LiveReload=new v(window);for(k in window)k.match(/^LiveReloadPlugin/)&&(v.log("Adding plugin: "+k),v.addPlugin(window[k]));v.on("shutdown",function(){return delete window.LiveReload}),v.on("connect",function(){return e.fire(document,"LiveReloadConnect")}),v.on("disconnect",function(){return e.fire(document,"LiveReloadDisconnect")}),e.bind(document,"LiveReloadShutDown",function(){return v.shutDown()})}).call(this);